
# 🛠 正規表現チェーン変換ツール 企画書（v1.1 / 拡張版）

---

## 📌 概要

複数の正規表現ルールを順番に適用してテキストを処理するWebツール。各ルールはドラッグ＆ドロップで並び替え可能で、変換はリアルタイムまたは手動の切り替えができる。さらに、**URL形式やJSON形式でルールの保存・共有・再読み込みが可能**。

---

## 🎯 目的

- ノーコードで複雑な正規表現変換処理を実現
- ルールセットを視覚的に整理・順序制御
- テキスト整形や一括変換作業を効率化

---

## 🧩 機能一覧

### ✅ テキスト入出力
- 入力テキスト：自由入力欄
- 出力テキスト：変換結果の自動/手動表示
- 入力内容に応じてリアルタイム変換 or ボタンによる変換

### ✅ 変換モード切替
- チェックボックスまたはスイッチUI
  - リアルタイム変換：ON/OFF

### ✅ 正規表現ルール管理
- 各ルールは以下の情報を持つ：
  - **検索正規表現**（search）
  - **置換文字列**（replace）
  - **フラグ**（flags: `g`, `i`, `m`など）
- ルールは配列として上から順に適用
- 各ルールの操作：
  - ✏️ 編集
  - 🗑️ 削除
  - 🔀 **ドラッグ＆ドロップで順序入れ替え**
- ルールは複数登録可能。ルール追加機能あり

---

## 🖼️ UI構成（イメージ）

```
┌───────────────────────────────┐
│ [✓] リアルタイム変換                        │
└───────────────────────────────┘

┌─── 入力テキスト ─────────────────────┐
│ [ inputBox（テキストエリア） ]              │
└──────────────────────────────────┘

┌─── 変換後テキスト ───────────────────┐
│ [ outputBox（テキストエリア） ]             │
└──────────────────────────────────┘

[ 変換ボタン ]（リアルタイムOFF時のみ表示）

┌─── ルール一覧（ドラッグ可能） ─────────┐
│ ☰ `/(\d{4})年/gi` → `$1年（西暦）`     ✏️ 🗑️ │
│ ☰ `/([A-Z]+)/g` → `$1 (大文字)`       ✏️ 🗑️ │
│ ...                                      │
└───────────────────────────────┘

[ + ルール追加 ]
```

---

## 🔗 ルールの保存／共有形式

### URL形式（エンコード付き共有リンク）
- クエリパラメータにルールをエンコードして共有可能
- 開くだけでルールが復元
- 例：
  ```
  https://yourtool.app/?rules=ENCODED_STRING
  ```

### JSON形式
- ルールをJSONで出力／入力可能
- モーダルで編集・保存
- JSON例：
```json
[
  { "search": "\\d+", "replace": "数字", "flags": "g" },
  { "search": "foo", "replace": "bar", "flags": "i" }
]
```

---

## 📂 UI追加（保存・読み込み）

### 操作パネル例：
```
[💾 JSON出力] [📂 JSON読込] [🔗 URL出力]
```

### JSON出力モーダル：
- テキストエリア（読み取り専用）
- コピー可

### JSON読込モーダル：
- テキスト入力欄 + 読込ボタン
- JSON形式のバリデーションあり

---

## 🔧 技術スタック

| 項目           | 内容                                  |
|----------------|---------------------------------------|
| フレームワーク | React + TypeScript                   |
| UIスタイル     | Tailwind CSS                          |
| D&D操作        | @dnd-kit/core または react-beautiful-dnd |
| 状態管理       | useState / useReducer                 |
| URL読込/書き出し | `btoa()` / `atob()` + JSON.stringify |

---

## ⚠️ JSON入力のバリデーション要件

- `search`, `replace`, `flags` を含む配列形式であること
- `search` は正規表現文字列（バックスラッシュは `\\`）
- 不正なJSONはエラー表示

---

## 🔁 ルール構造の仕様

```ts
type Rule = {
  search: string;
  replace: string;
  flags: string;
}
```
